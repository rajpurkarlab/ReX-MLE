FILE: rdagent/utils/env.py

PATCH 1: DockerEnv.prepare() method - Add no-docker mode check
LOCATION: Line 774 (in prepare method)
SEARCH FOR:
    def prepare(self, *args, **kwargs) -> None:  # type: ignore[no-untyped-def]
        """
        Download image if it doesn't exist
        """
        client = docker.from_env()

REPLACE WITH:
    def prepare(self, *args, **kwargs) -> None:  # type: ignore[no-untyped-def]
        """
        Download image if it doesn't exist
        """
        # Skip Docker if using conda/local mode (no-docker patch)
        import os
        if os.getenv('DS_Coder_CoSTEER_ENV_TYPE') in ['conda', 'local'] or os.getenv('DS_Runner_CoSTEER_ENV_TYPE') in ['conda', 'local']:
            logger.warning("Docker prepare() called but conda/local mode is enabled - skipping")
            return
        client = docker.from_env()

---

PATCH 2: DockerEnv._run() method - Add no-docker mode check
LOCATION: Line 873 (in _run method)
SEARCH FOR:
        if env is None:
            env = {}
        env["PYTHONWARNINGS"] = "ignore"
        env["TF_CPP_MIN_LOG_LEVEL"] = "2"
        env["PYTHONUNBUFFERED"] = "1"
        client = docker.from_env()

REPLACE WITH:
        if env is None:
            env = {}
        env["PYTHONWARNINGS"] = "ignore"
        env["TF_CPP_MIN_LOG_LEVEL"] = "2"
        env["PYTHONUNBUFFERED"] = "1"
        # Skip Docker if using conda/local mode (no-docker patch)
        import os
        if os.getenv('DS_Coder_CoSTEER_ENV_TYPE') in ['conda', 'local'] or os.getenv('DS_Runner_CoSTEER_ENV_TYPE') in ['conda', 'local']:
            raise RuntimeError("DockerEnv.run() called but conda/local mode is enabled. This should not happen!")
        client = docker.from_env()
